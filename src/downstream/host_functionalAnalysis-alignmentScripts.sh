#!/bin/bash -login
#SBATCH -t 04-00:00:00
#SBATCH -c 16
#SBATCH --mem=32G
#SBATCH --mail-type=FAIL
#SBATCH --mail-user=jknorris@ucdavis.edu
#SBATCH -p med2
#SBATCH --output=/home/jknorris/.slurm_output/Btaurus/%x.%j.out
#SBATCH -A ctbrowngrp

set -e  # Exit immediately on error
set -o pipefail
set -u
source ~/.bashrc

# Job information logging (improved)
echo "Job ${SLURM_JOB_NAME}_${SLURM_JOB_ID} running on:"
echo "  NODELIST: ${SLURM_NODELIST}"
echo "  Job details:"
scontrol show job $SLURM_JOBID


# Define nproc explicitly for better control and portability
nproc=$SLURM_CPUS_PER_TASK

:<<'NOTES'
############################################################################
#notes goes here
##########################
to run:
for f in *_R1_001_trim.fixed.gz; do sbatch -J H_$(basename $f) script.sh ${f}; done


██████         ████████  █████  ██    ██ ██████  ██    ██ ███████ 
██   ██           ██    ██   ██ ██    ██ ██   ██ ██    ██ ██      
██████            ██    ███████ ██    ██ ██████  ██    ██ ███████ 
██   ██           ██    ██   ██ ██    ██ ██   ██ ██    ██      ██ 
██████  ██        ██    ██   ██  ██████  ██   ██  ██████  ███████ 
                                                                  i

#IDSEQ,RFI

1,Most

2,Most

3,Most

4,Most

5,Least

6,Most

7,Least

8,Least

9,Least

10,Least

11,Most

12,Least

13,Least

14,Most

15,Most

16,Least

17,Least

18,Most

19,Most

20,Least

21,Most

22,Least

23,Least

24,Most

####################
SampleID,SampleID,RFI_group,Somatotropin,xylose,xanthine,valine,uracil,tyrosol,tyrosine,tyramine,tryptophan,tocopherol.alpha.,thymine,thymidine,threonine,threonic.acid,tagatose,sucrose,succinic.acid,stearic.acid,spermidine,sophorose,serine,salicylic.acid,ribose,ribonic.acid,ribitol,quinic.acid,putrescine,pseudo.uridine,proline,pinitol,phytanic.acid,phosphoethanolamine,phosphate,phenylethylamine,phenylalanine,phenylacetic.acid,pentadecanoic.acid,pantothenic.acid,palmitic.acid,oxoproline,ornithine,oleic.acid,oleamide,nonadecanoic.acid,nicotinic.acid,N.alpha.acetyllysine,N.acetylmannosamine,N.acetyl.D.galactosamine,myristic.acid,myo.inositol,mucic.acid,methionine.sulfoxide,methionine,mannose,mannitol,maltotriose,maltose,malic.acid,maleimide,maleic.acid,lyxose,lysine,linoleic.acid,lignoceric.acid,leucine,lauric.acid,lactose,ketoisoleucine,isothreonic.acid,isopentadecanoic.acid,isopalmitic.acid,isomaltose,isolinoleic.acid,isoleucine,inositol.5.monophosphate,inosine,indole.3.acetate,hypoxanthine,hydrocinnamic.acid,heptanoic.acid,heptadecanoic.acid,guanosine,glycine,glycerol.alpha.phosphate,glycerol.3.galactoside,glycerol,glyceric.acid,glutaric.acid,glutamic.acid,glucuronic.acid,glucose.6.phosphate,glucose.1.phosphate,glucose,gluconic.acid,galacturonic.acid,galactonic.acid,fumaric.acid,fucose,fructose.6.phosphate,fructose,ethanolamine,dehydroabietic.acid,conduritol.beta.epoxide,citrulline,citric.acid,ciliatine,cholesterol,cerotinic.acid,cellobiose,caproic.acid,capric.acid,cadaverine,beta.sitosterol,beta.gentiobiose,benzoic.acid,behenic.acid,azelaic.acid,aspartic.acid,arachidic.acid,arabitol,alanine,adipic.acid,adenine,X6.deoxyglucose,X5.ketogluconate,X5.aminovaleric.acid,X4.aminobutyric.acid,X3.hydroxyphenylacetic.acid,X3.aminoisobutyric.acid,X3..4.hydroxyphenyl.propionic.acid,X3..3.hydroxyphenyl.propionic.acid,X2.ketoisocaproic.acid,X2.hydroxyisovaleric.acid,X2.hydroxyglutaric.acid,X2.deoxyuridine,X2.Deoxyinosine,X2.deoxyerythritol,X2.aminobutyric.acid,X2.8.dihydroxyquinoline,X1.monostearin,X1.monopalmitin,X1.3.diaminopropane

5,1_Rumen Sources_05,Least,12.443,1.646255618,-0.308721596,1.341539363,0.699169882,-0.238600769,0.553409117,-0.06185535,0.541837208,-0.137312617,0.548473717,0.173403649,-0.162611518,0.192879187,2.315617737,-0.411028267,1.138791917,-0.712043451,0.3306188,-0.335985348,0.361828969,0.789888874,1.392751818,0.960655387,1.177179966,0.30929353,-0.330891009,0.215798109,0.351352772,0.364114413,0.002223747,-0.940342645,-0.466021173,-0.262305594,-0.053246749,-0.719760967,0.187144068,1.406211836,-0.571539599,1.573665151,-0.070515167,-0.316078559,-0.75033113,-0.097841339,1.835758443,0.518380083,-0.210902974,-0.150944234,-0.299929401,-0.137494351,1.600141781,1.079642643,0.50638503,-0.122550665,0.61211957,-0.37565675,-0.51192509,0.923044137,0.502163539,2.062242668,0.89874322,0.634569415,-0.770029972,0.848518165,1.010099831,0.803016385,-0.515900457,2.256601864,0.960961942,0.769137416,0.249458771,-0.060146795,0.285580658,0.529600592,0.25405984,-0.943703239,-0.590667711,0.43968323,1.408294064,0.372196335,-0.39429543,-1.163002769,1.693500554,0.154608065,1.034305759,1.287920672,0.540248432,-0.244322758,1.407736661,1.916459155,-0.173684205,0.541322222,0.239547888,-0.314094264,-0.441180456,-0.232931593,1.358936879,0.133338021,-0.392182429,0.214404978,-0.742623137,1.602702886,0.582178022,2.029244708,1.470128307,-0.463843407,-0.277780723,2.11671746,-0.109799645,0.681661915,0.615714309,-0.676890627,1.046895604,-0.093089169,2.877791517,0.471635435,0.935536183,-0.46597917,-2.85037786,1.283911524,0.705481962,0.625613313,1.040666693,1.353929998,-0.070729625,-0.408171094,-0.418900171,0.633331742,-0.207407471,-0.169931158,-0.094126347,0.777668208,-0.134942974,2.635889575,-1.028873428,-0.68610177,1.692466857,0.09896774,1.278099323,-0.351891542,0.13996331,-0.047262066

7,1_Rumen Sources_07,Least,26.157,0.72857074,2.189635235,0.896329035,0.973906413,-1.271728616,1.005782222,0.203399868,0.578028049,-0.469779272,0.710566538,-0.553124446,0.07188752,-0.409980412,0.596965492,-0.520635804,-0.17990352,0.146296996,-1.119902409,0.981229938,1.564055099,0.360872378,0.916773093,-0.575442088,0.560028353,-0.924134417,0.718863035,2.134770808,1.203571819,-1.028463518,1.381415017,0.336517207,-0.56273871,-0.325754546,1.793577006,-0.462881306,0.359495883,1.993152429,-0.600514362,0.961815394,0.211319942,-0.783158567,-0.558884516,-0.819421212,1.218417658,2.825060212,1.349987378,-0.583138449,0.502322536,-0.294618219,1.451072892,0.836990526,0.548864026,-0.636970899,-0.242725685,-0.907817235,-0.525449506,0.664658411,0.186127182,1.40703902,0.173680296,1.483683267,-0.888503793,0.292079761,1.232432849,0.365339021,-0.166547425,1.048411535,0.287752048,0.655368858,0.216893442,-0.141636001,-0.542320497,1.203599328,-0.490665188,0.539778071,0.129311707,1.362068774,-0.896847844,-0.710972935,0.162827352,-0.961713828,1.273737703,1.157818801,-0.228201095,-1.179265716,0.102540724,-1.302265141,1.310405612,0.036078326,-0.637723451,-1.16165652,-0.103497026,1.542537658,0.100173899,-0.03964294,0.103969068,-0.707378515,-0.537802909,-0.254009353,-0.78888406,-0.475275344,0.594805069,0.634019973,-0.108325244,-0.275447907,-0.365870623,-0.52926079,0.190690052,-0.972704654,-0.387413504,-0.473664752,-0.447681068,0.471683292,-0.579448377,1.040030777,0.11326901,-0.014775602,0.948144202,0.410092185,0.97649156,0.143051272,-0.611114909,1.246369418,-0.436229742,-0.391202378,-0.372741968,-0.893132507,-0.377426499,-0.817518945,-0.96234854,1.745216562,-0.619737169,-0.906746014,-0.897717137,-0.404709006,-0.995900567,0.911812246,-0.423451089,-0.392158012,-0.994939184,1.055061186

8,1_Rumen Sources_08,Least,23.942,0.345440519,1.348839805,0.891059717,0.749144492,-1.655646689,0.714086679,-0.331188609,-0.160265108,0.142659303,0.840544583,0.267094917,0.08961597,0.596579812,-1.121686753,-0.166814981,1.605329421,0.73579248,-0.277599749,-1.149222612,0.060206093,-0.20837389,1.395274318,0.89883103,0.291126579,-0.05314885,-1.064573716,2.502298966,1.520934642,-0.440770079,1.977964398,-0.301912719,-0.325979845,-0.357615178,1.465931719,-0.840472491,0.185750763,1.502431606,-0.507980734,2.308853599,-0.796587368,-0.168468624,0.132118106,-0.072022097,0.109916534,0.539738232,-0.235904494,2.915692247,-0.540863356,-0.075644922,0.651028099,1.000697605,0.841969097,-1.056796322,1.211250917,-0.67155633,-0.961188325,0.025727519,-0.117146169,1.815730404,-0.472912614,0.488528676,-0.983043509,0.755778431,1.156676102,0.622236604,-0.346068151,2.135378754,1.485071658,0.366894282,0.202489546,-0.942558484,-0.203016745,1.429672874,0.293955824,-1.00698914,-0.566022939,1.741272812,-0.960007112,-0.063788731,0.41739781,-0.559135946,1.020044486,1.588684951,1.443214861,-0.76131624,2.01383526,-1.001382445,1.727013986,0.087772645,-0.137988878,-1.496115408,-1.056710527,-0.569706408,-0.400464876,-0.364292813,0.291113391,-0.616605241,-0.70989984,-0.446267003,-0.98452794,2.825436056,-1.231137119,-0.243326584,-0.001190387,2.17852424,-0.350945092,0.221149585,-0.890473876,-0.180662288,0.00319023,-0.87104868,-1.829334169,-0.53991718,-0.01372143,2.045227988,0.07522818,1.502802907,1.370752695,0.706063252,0.83966944,0.001226672,0.737323423,0.143066775,-0.008028768,-0.392266304,-0.467182809,0.37202176,-0.339644493,-0.857538415,-1.02531648,3.430387639,-0.628832745,0.796100673,0.009912299,2.034304163,-0.802015288,1.021162007,-1.434311462,-0.335388891,-0.006398323,-0.517476663

9,1_Rumen Sources_09,Least,17.658,0.062695831,-0.148760796,0.336228755,0.265198099,0.522764848,0.161773677,-0.528395334,-0.07774999,-0.498943013,-0.736117314,0.09878725,0.503817019,0.661171912,-0.133081479,-0.657164492,0.769607768,-0.79998293,-0.54969752,-1.034682152,0.448659797,1.269201559,0.603259468,2.097272404,-0.079164388,-0.232965225,-0.934371399,-0.107994965,-0.119777252,-0.159699304,-0.202126894,-0.755582122,-0.363402059,-0.396011326,-0.122779189,-0.800850505,-0.495435997,0.068757043,-0.806463103,0.764206735,-0.456896553,-0.761860562,-0.253766475,-1.008309353,0.433032819,0.28344044,-0.612631943,-0.512724785,-1.044693075,-0.295539381,0.446841302,0.298502268,-0.453640277,0.169035401,0.51384935,0.72651184,1.468772426,-0.575445002,-0.134163511,0.735617461,-0.240641374,-0.177148231,-0.354773247,-0.911520702,0.278798389,0.425598948,-0.294206608,0.8625361,1.069398435,-1.89422087,-0.124416257,0.23554261,-0.95400905,0.422988449,0.054579922,-1.071769983,-0.926892819,-1.621396464,1.218878578,3.236141173,-0.827131849,-0.065063092,0.193848058,1.02920204,1.703894414,-0.071840212,0.39085119,-1.01386145,0.300366418,0.268702759,0.211032093,1.155008255,-0.195061019,0.099170879,-0.561372849,0.179917957,-2.34725461,-0.274077964,1.057403258,0.143656267,-0.658250564,-0.613361786,0.14876796,0.58832484,2.080796989,-0.451766772,-0.436108418,0.776140592,-1.34803017,2.733891535,0.076764899,-0.816179472,0.568631069,0.281157642,0.120056979,-1.65708253,0.594631821,-0.011270352,-0.359316307,1.382568546,-0.164576961,-0.028725455,2.223041191,0.336406916,1.713950862,-0.430188949,-0.435123137,-1.396348264,0.04762107,-0.39731451,-0.334967231,0.585473935,-0.465718751,2.201246889,-0.074502122,0.27063363,-0.29796132,-0.311912011,0.001291009,1.666712809,1.142900397,-1.144085733

10,1_Rumen Sources_10,Least,16.475,0.705826614,0.371170701,0.330394867,0.110668088,0.475314299,0.587582113,-0.089184307,-0.228303889,-1.152210826,0.237307579,-0.729847496,0.717364252,0.036781612,1.281384528,0.048554216,-0.114158398,-1.095425328,-0.547696801,-0.072542291,0.582815965,0.76157645,0.457748384,0.775182317,0.383699321,-0.747127673,-0.737307509,0.253394936,0.31996524,0.32578658,-0.240749868,-1.04827206,-0.825483152,-0.397917517,0.537778994,-0.956339405,-1.980838339,-0.23433523,-0.839218369,0.673369931,-0.404115908,-0.729175505,-1.281296348,-0.790884155,-0.160722836,0.459645172,-0.726275216,-0.699685204,-0.832826219,-0.235137492,0.783394591,0.463871347,0.459658134,1.427048863,0.694539756,2.575310764,2.54659214,-0.257830456,-0.516445951,-0.425585042,-0.032434272,0.588129682,-0.39187111,-0.87321516,0.340572921,-0.16177676,0.847317247,0.636252962,0.488811379,-1.29518888,-0.062416881,0.971273728,-0.91781665,0.696824528,-0.344379914,-0.938720097,-1.062439066,0.265377249,-0.633009116,1.210048522,-0.870115604,0.984079266,0.485999506,0.27036315,-0.225645414,-0.801066663,0.056090704,-0.424575064,0.573995217,1.173353329,0.234828978,0.618032976,0.434680362,0.16498718,1.995565593,0.493308297,-0.31313037,0.412749506,1.289072203,0.392460285,-0.334301553,-0.739198624,1.005984415,-0.014850918,0.609478294,0.154480284,-0.318752769,-0.771580807,0.506819856,1.039391615,-0.244451341,-0.723367655,-1.168399152,0.562409792,-0.844881727,-0.093442425,-1.010398586,0.502443507,-0.697700364,0.576869532,0.176994425,-0.277814508,2.26732488,0.793808281,2.420482469,-0.42937748,-0.455594976,-0.701677669,-0.44354501,-0.635612263,-0.547311674,0.199623836,-0.567892386,-0.067230689,-0.347279301,0.443607417,-0.183110558,-0.087570087,-0.047767348,-0.3908378,-0.558253658,-0.279619572

12,1_Rumen Sources_12,Least,17.675,0.194219156,1.207725638,0.88988353,2.303607447,1.318639954,0.428838872,0.451673397,-0.365829085,0.171823045,1.0788015,-0.415112159,-0.305244953,-0.200056087,0.05703492,-0.522558744,-0.24248782,-0.4118505,-0.735764379,3.146044625,0.944154077,0.824863045,1.170138653,-0.456549095,0.555620127,-0.719031364,0.686936292,0.464397531,0.747659992,-0.970971769,1.42530476,1.289588815,-0.503430962,0.010824446,0.112507351,-0.204617472,0.287740681,1.006899794,-0.599709129,0.98792922,0.22756014,-0.233206124,0.154553256,-0.361469391,0.31097977,1.794529506,1.573864626,0.660026933,0.092799405,-0.266720179,2.339640386,1.150277677,0.905687591,0.321167261,0.129221818,-0.625680426,-0.2813044,1.444257751,0.038440961,-1.304595876,4.176697247,1.427222329,-0.383494173,0.632797479,0.545684905,-0.113568818,-0.424905295,0.145299366,-0.202471264,-0.587140334,0.149257758,0.633675588,-0.293497746,0.339504974,0.47348775,0.960853552,0.500743632,1.197107639,-0.876687979,-0.48981015,0.045205138,-0.107760746,1.272863653,0.810553546,-0.271647688,-0.135152072,-0.281873231,0.762317046,-1.385218472,0.889034579,-0.451314523,0.265163507,0.567152506,1.790496744,0.162387306,1.861341579,0.672741029,-0.129762641,-0.544422022,-0.869181234,0.048775659,-0.303780892,0.98446508,1.3864665,-0.683282306,0.333214476,-0.289779679,-0.154055602,0.037283905,-0.473364324,-0.268976231,-0.196687265,-2.337490237,1.04326024,-0.209139361,0.066902565,-0.183742086,-0.396068907,-0.020436812,0.80706925,0.843003068,-0.288310553,-0.887887966,0.622249156,-0.339884523,-0.431992213,-0.438406356,-0.951345127,-0.282971484,-0.63743133,-0.799183437,-0.2666117,-0.473904769,-0.25775899,-0.064037524,-1.098673221,-0.225134953,0.920727242,-0.507366701,-0.569726544,-0.186351149,1.277794416

13,1_Rumen Sources_13,Least,2.563,-0.446136302,-0.405075009,1.101879486,0.425126756,0.460216398,0.893333719,0.199321828,0.798068362,-1.041388608,0.625288789,0.766407661,1.0042428,0.246705937,1.007616913,0.03893952,-0.922696971,-0.337051702,-0.359629224,-0.038180153,0.106109641,0.559725521,0.703626841,-0.589709247,-0.259901646,1.334808794,-0.578186536,0.314777509,0.921084032,-0.427994135,0.068936156,-0.720825192,-0.511332864,3.255979658,0.235067057,-0.621426925,-0.27989173,-0.191036334,-0.638510472,0.498926764,-0.579374715,-0.525684667,1.234431812,-0.286729479,-1.16073236,0.288779978,-0.7569589,-0.56371399,-0.164928874,-0.147232346,0.302783132,0.664142443,0.582847222,-0.900763645,-0.128605428,0.361798404,0.37795969,0.045717245,-0.354781199,0.171234121,-0.524702823,0.753968412,-0.525902099,0.223533001,0.807436709,1.583858173,-0.181934916,0.649385465,0.134133683,0.342016146,0.027137774,-0.204499103,-0.9042445,1.179149023,-0.470717196,-1.050342473,-0.601229757,0.510408964,0.632185999,1.191781835,-0.333651682,-0.565235611,0.75739225,-0.160503,0.344271648,-0.371374471,0.462783195,-0.399617052,0.373299118,-1.139967415,-0.368025428,1.774831149,-0.169896849,-0.217665731,-0.822604012,-0.242314537,0.368172818,-0.764820978,-0.385563316,-0.478879792,-0.648753289,-0.279281685,0.539495045,0.375080885,1.577263164,1.014336666,-0.328995781,2.968745907,-0.30280521,1.336145763,0.377045258,-0.63542757,0.50552672,-0.902823179,1.007312191,0.543514223,1.124277224,0.868352659,0.552289353,0.339622884,-0.068995042,0.27028381,1.166875207,-0.498532081,-0.653388807,-0.404708827,-0.478577512,-1.357539851,-0.604118537,-0.264522633,-0.29084371,-0.403997721,-0.364151487,0.557940297,0.971957644,0.92238893,0.241908895,-0.478250037,0.938563846,-0.292481996,-0.003998952,-0.913446849

16,1_Rumen Sources_16,Least,0.155,-1.085544088,-0.239224636,-0.58952456,-1.145036844,-0.514676686,-1.213786161,-0.747574784,-1.347324693,1.414198439,-1.245613891,1.309480399,-1.294008936,1.791533662,-1.288989184,-0.24757843,1.595846951,0.648798867,0.138549784,-1.080498336,-0.935454068,-1.095718569,-1.010698543,1.640723309,-1.000483581,-0.24701338,-0.896325933,-0.328204947,-0.147360235,-0.255518886,-0.927887677,-0.78850974,1.716332487,-0.368780016,-0.857786247,0.562388051,-0.442769072,-1.10993513,0.651118975,-0.331169999,-0.923802255,-0.108792036,0.405826937,1.002873723,-0.982664626,-0.982029908,-0.76945966,-0.811375844,0.187105994,-0.368837534,-0.871395343,-1.120015412,-0.997371424,-0.260054463,-0.965487309,0.247108645,-0.590279588,-1.055938802,-0.12565484,-0.727238207,-0.755404662,-0.966868109,0.155023194,0.417076794,-0.388595641,1.180433821,-0.529388257,0.161462448,0.798307202,-0.288323163,-0.748793817,-1.07061295,-0.365882546,-0.727864668,2.927090743,2.035218921,2.998667335,-0.417681854,0.015907961,-0.129307263,-0.213363809,1.703839721,0.280816103,0.379687397,-0.45054542,0.278997173,1.146137245,0.645846325,-0.680814514,-0.907342983,0.01669087,-0.268743342,-1.157105202,-0.935522591,-0.48775908,-0.585730299,0.69720434,-0.097495579,0.660256494,-0.056491575,-0.869335177,0.366606511,-1.213352545,-1.160275591,-0.661855335,0.787295936,0.003755771,-0.126696891,-1.037224658,-0.463534561,0.413533509,-0.24593798,1.056859448,1.21564059,-0.123433881,-0.185226109,-0.246655767,0.502054035,-0.278064498,-1.250634354,0.342815522,-0.118325834,-0.24356029,-1.260329885,-0.02332166,0.849840073,0.929923615,0.254302907,1.492782807,2.20758917,0.775934325,-0.265880924,1.019588791,0.581756334,2.270265393,0.170904723,-0.286022571,0.878070679,-1.245824087,-0.338029315,-0.171954923,-1.024126015

17,1_Rumen Sources_17,Least,20.14,-0.592145469,-1.135853217,-1.466348493,-1.376237516,-0.020759615,-1.315789333,-1.472309498,-0.452687103,1.79332708,-1.384705589,-0.990163353,-1.094966798,-0.560695312,0.26236063,-0.322573061,-1.114875022,1.522612813,-1.013864307,-0.565066268,-1.05752501,-1.029767275,-1.078002067,-0.760915158,-1.419265033,3.031825833,1.301081718,-1.171448048,-1.191709023,-0.849600298,-0.896638181,1.132267974,0.197682656,-0.319491344,-1.133106617,-0.365989113,-0.301905948,-0.354609941,-0.129370793,-1.220093069,-0.157129558,0.573376734,0.550907574,0.440286025,1.260870892,-1.046104356,0.047635472,-0.527293129,-0.066100737,-0.462796028,-0.769093164,-1.13580442,-1.277732797,-0.262004871,-1.348001503,-0.804596451,-0.181567823,-0.634673821,-0.763805177,-0.649392229,-0.357823261,-1.44287537,0.07005712,1.098512231,-1.452112932,-0.905193962,-0.370954093,-0.601232952,-0.907308469,0.047112389,-0.594108504,-0.441981932,-0.659945798,-1.391914407,0.406994444,-0.63375182,-1.062439066,-0.89308863,-1.29432747,-0.976217312,0.63431583,-0.211455049,-1.448493216,1.788040931,-0.729114746,-0.256151447,-0.074813896,2.566226666,-1.296544901,0.061925485,-0.36405928,-0.695255135,-0.319798128,1.305292853,1.764952546,1.962677377,-0.755916284,1.086457401,-0.484850007,-0.251116283,-0.213532969,-0.398436921,-1.193433822,-1.154182907,-0.897552019,-1.328530443,0.068725731,-0.095429792,2.335713961,-1.25728308,-0.240264165,-0.128945306,0.316213675,-0.115770794,0.201397554,0.760256416,-1.204992063,-1.123797752,0.71727016,-0.804328778,-1.323048453,-0.596023854,0.212561708,-0.351174088,2.246143501,-0.100227675,-0.280811825,1.0615179,-0.44354501,-0.34638064,0.086504315,-0.754770538,-0.594875928,-0.597137525,0.445937202,-0.325256931,-0.623411608,-0.897254848,-0.525440833,0.066615704,-0.248734796,1.977273

20,1_Rumen Sources_20,Least,19.288,-0.359762775,-1.689473071,-1.935976464,-0.995855948,2.287062508,-1.63392059,1.24256975,-1.080960103,-0.008992154,-1.01061185,0.885345079,-1.206172527,-0.889038487,-0.893547074,0.079321244,-1.10918554,0.375995895,0.228582135,-0.794147187,-1.175025908,-0.748974646,-1.40282172,-0.661045043,-1.454530839,0.115429001,-0.821687771,-1.474524504,-0.977386078,-0.542977634,-0.957732702,-1.355596494,2.805999755,-0.35952137,-1.362774374,3.987700107,-0.70164512,-1.158045015,0.794355027,-1.64563612,-0.854443075,0.279211221,-1.263348228,0.254115699,-1.081722173,-1.232988163,-1.397906958,-0.626843482,0.609547835,-0.404236462,-0.88266946,-1.38593554,-1.600573165,-0.095732549,-0.721396761,0.389323946,-0.737963595,-1.439445409,0.149661448,0.11609322,-0.188328032,-1.722002607,0.498477604,-0.51435271,-1.50290708,1.661878921,0.146711493,-0.321409607,-1.119663268,0.36130369,-0.530856615,-1.026375953,0.765129961,-1.473525561,-0.936170338,-0.813643238,-0.896967024,-1.474239722,1.553105459,1.187705797,-0.390630148,0.08742853,-1.163771199,-1.408085582,-1.010239754,1.396721304,-0.265419149,-0.111213362,-0.856325221,-1.01073162,-0.510806734,0.998518317,-1.283122552,-0.762563475,-0.950288072,-0.859712273,1.149775578,-0.382580393,-0.352467753,-0.885750635,-0.19459969,2.101595837,-0.446303879,-1.501465919,-0.229744748,-1.084582424,-0.314655565,0.479103152,-0.277182057,1.459899959,0.412337173,-0.119024043,0.568631069,-0.821169329,1.577934909,-1.638283462,1.868999628,-1.569743445,0.011766649,-2.265392296,-1.728370989,0.45486059,-0.278987241,-1.213809935,-0.777261232,-0.390643366,-0.460809501,2.384884787,-0.094061453,0.232082608,0.348487719,-0.434690342,0.576937431,-0.168448849,0.998467958,-1.147089329,1.877039912,-0.865657394,1.168363522,-0.361793133,-0.462278817,-0.69415086

22,1_Rumen Sources_22,Least,19.032,-1.129746214,-1.003926783,-0.308980421,-0.926664145,1.055505095,-0.667147166,2.877437847,-0.62640314,0.393467481,-0.970685372,0.172842623,-0.136018843,-0.883655812,-0.37643047,-0.045669807,-0.562995292,-0.346592906,0.470669123,-0.736876957,-0.624183322,-1.036429022,-1.165616242,-0.3614347,-1.278201807,-0.232965225,0.217743065,-0.749442856,-0.665413034,0.32578658,-1.005133624,0.887140151,-0.255906378,-0.067601727,-0.749273499,0.669373181,-0.84682749,-1.201343911,0.993247737,-1.242205584,-0.563811192,-0.441125261,-0.071293921,-0.741963486,-1.335262324,-1.040764819,-0.84446422,-0.464163637,-0.406508764,-0.248691728,-0.871395343,-0.884011299,-0.797720143,-0.270294107,-0.0715453,0.648522803,0.492705974,-1.673399247,-0.823973637,-1.252698557,-0.785223268,-0.692018216,0.545149109,-1.062726791,-0.263190182,-1.347311531,4.128272231,-0.881056297,-0.487117058,-0.96478486,-0.843358523,-0.791221387,-0.614705298,-0.699633009,0.207514526,0.69226221,0.782398172,-0.767179118,0.976227962,-0.444973736,-0.811804308,-0.473740638,-0.669277013,-1.363069716,-0.851787477,0.717619909,-0.909603747,0.6403001,-0.791000608,-0.816877926,0.119810703,0.038099675,-0.897252104,-0.770216533,-0.163663061,-0.758376474,-1.405417169,-0.097495579,-0.100941469,-0.374729273,1.157567283,-0.192420858,-0.560125151,-0.825177947,-0.708280439,1.557785223,-0.421475544,-0.634787249,0.634935618,0.04005176,-0.414929235,2.974845427,-0.085661385,-0.415168243,-0.632712002,-0.492646158,-0.489531836,-0.18711706,-0.350893863,-1.039226449,1.133691824,-0.445751218,-0.989740451,-0.870960588,-0.526457805,1.671912133,2.191452391,1.216751552,3.76914868,1.578192052,2.315201727,-0.66780811,2.849315472,-1.132998371,0.521282305,0.890939151,-0.782435741,1.347744264,-0.125227913,3.992926587,2.976019857,-1.029625601

23,1_Rumen Sources_23,Least,11,-0.786553596,-0.709448138,-0.532361868,-0.430830828,0.524921691,-0.594416713,-0.374525395,-1.587631877,0.434296719,-0.317974254,0.939203532,-0.785524769,-0.226969462,-0.802291203,4.173258928,1.076839783,0.286688333,2.463385157,-0.839963371,-0.667751071,-1.108708975,-0.678884229,-0.584953528,-0.951993098,0.126667525,-0.784838704,-0.05658706,0.015284248,3.807231409,-0.927185441,1.346297491,0.054957664,-0.407176163,-0.519605742,-0.274575943,-0.553815472,-1.018526349,2.249589644,-0.637165076,-0.772227071,0.404047051,-0.552901809,0.680812649,-1.109434702,0.806715099,-0.793324747,-0.398606088,0.683830421,0.159119719,-0.873483142,-0.710332216,-0.347442787,2.026799468,-0.539649685,3.037510495,0.357291944,-0.488082492,-0.851322937,-0.652635811,-0.523656556,-0.616370336,3.642222322,-0.044605796,-1.065745624,0.098926713,1.523606966,-0.14260552,-0.114366614,0.820291337,-0.258435112,-0.632899501,2.312355072,-0.686159643,1.736860565,1.288744282,-0.106573971,0.220521985,-0.398288462,0.167035772,-0.188373253,0.78888999,-0.317471604,0.894154441,-0.399431782,2.204536545,-0.064038657,-0.331675798,-0.588205726,0.210546651,2.796960201,-0.713665716,-0.972387336,-0.949298095,0.262059047,-0.662670442,-0.820744056,0.146457596,2.434178705,0.635478164,-1.153701994,-0.332734501,-1.077478401,-0.82822429,-0.344021928,2.065003875,-0.21427405,-0.544894339,-0.175687752,0.173519391,-0.243853173,0.030719467,1.525160139,2.111564774,-0.711398244,-0.558995808,-0.593412564,0.55385384,0.095495647,-1.041575426,-0.026679477,-0.570167745,0.757251083,-0.729518426,-0.76196834,0.051733394,0.273665994,0.734233616,-0.046833945,2.836986288,0.699637404,0.129469273,0.87527232,-0.144632811,1.285197934,1.644078609,-0.826609111,-0.112960898,-0.93081779,-0.352551648,-0.35190775,-1.013470568

1,1_Rumen Sources_01,Most,8.305,-0.478966365,0.06255708,0.816113077,-0.288732558,0.6004112,0.219029566,0.478637156,-0.572840695,-0.942231887,0.339944666,-0.922279261,0.232249405,0.026016262,-0.125476823,0.346609802,-0.293693155,-1.048787825,-0.539693926,-1.023228106,-0.73965309,2.203178466,0.413247861,0.038045758,0.083939966,0.109809739,-0.46893828,-0.171679385,0.332012979,1.290370377,0.675316839,-0.512283612,-0.755266804,-0.362244501,0.348145066,0.245469835,-0.145019817,0.01583617,-0.757985308,-0.047006642,-0.249495686,-0.575028559,-0.573841283,-0.591124755,-1.487976043,0.187328768,-0.563765336,-0.867221164,-0.345144888,-0.182631275,0.088574896,-0.064644906,0.124074067,-1.17382083,-0.023995193,-0.517872052,-0.253149223,0.364072151,-0.254500432,0.878335087,-0.221285438,0.28566037,-0.379904057,-0.945794082,0.574439291,0.123664999,-0.472967458,0.299858832,0.933852819,1.08053342,-0.401847811,-0.637556027,-0.433743297,0.582245844,-1.328480844,-0.966127377,2.116736556,0.68609208,1.932201283,1.003076387,-0.525912355,-0.809222206,-1.955005599,-0.449890712,-0.156642003,-0.794416257,-0.454568289,2.643873814,0.085503534,-0.215931475,-0.824132379,-1.060398325,-0.293228671,-0.220726954,-0.840193143,-1.197498268,-0.086844751,-1.078627024,-0.802567418,-1.040661382,-0.566218899,0.038094412,0.402198136,-0.688092548,-0.004761549,0.248678034,-0.47181263,-0.220498187,-0.718432709,1.24122166,-0.073973448,2.85628811,-0.261689304,0.027123443,0.102892289,-0.210660141,0.547812338,0.979741714,-0.744766961,0.365461628,2.763441499,1.785042216,1.341795779,-0.414365928,-0.485166996,4.023062026,2.581576109,0.299579389,1.199972259,1.438123907,2.814808674,-0.296573545,2.275991006,-0.329207103,-0.684936985,-1.411929578,2.872015225,3.415797634,-0.623557548,-0.219210223,0.113570228,-0.843670852

2,1_Rumen Sources_02,Most,17.909,0.468231724,1.751922176,1.335940712,1.955122459,-0.7605568,1.591107628,0.199991357,1.188929445,-1.502175726,1.737805379,0.984646602,2.062308905,0.505074337,-0.703430675,-0.705237973,-0.180535685,-1.32246354,-0.323616284,0.649062605,1.980335291,-0.189720999,1.480295644,1.293555769,0.388107547,-0.207678548,-0.98477395,1.56161103,3.194302251,0.198027137,-0.485479072,-1.15254285,-0.22932443,3.195526149,2.40707788,-0.566059958,-0.562871953,-1.153234026,-0.992144521,1.348608896,-0.63350871,-0.546350057,-1.831705363,-0.97705448,-0.799290238,0.096556633,-0.710933374,-0.672976573,-0.97880765,0.023708948,1.377999907,0.527858378,3.059372682,1.071099318,0.003478202,0.3159225,1.404852683,0.18120317,-0.816680491,-0.876442998,-0.047082008,1.109232369,-0.725751878,-1.45586262,1.694122428,-0.872209581,0.142532174,0.769598382,1.588989964,-1.719514853,-1.431413216,0.372910129,-0.135155995,1.693743515,-0.031861376,-1.013467224,0.768315445,1.667300974,-1.052907634,0.362383652,-1.073372121,-0.046764097,1.314162548,-0.707124234,2.899953539,0.03270416,2.060285279,-0.830836032,2.104794879,-0.732874659,0.084115376,1.553904177,0.207512102,0.019579074,-0.769510896,-0.000234574,-0.644608223,3.163250632,-0.504707345,1.783763941,-0.708494217,-1.058801921,0.93484612,0.335478436,0.480916466,1.17616357,-0.180325782,-1.295304714,0.402663404,0.550811677,-0.526786659,-0.841818292,-1.842619295,1.18842264,-1.547867208,-0.71823497,-0.751428319,2.811040098,-0.935510536,0.717808135,0.592299923,-0.408631062,-0.278987241,-0.422432972,-0.292476558,-0.387361426,-0.489199692,-1.806423829,-0.528554524,-0.699279602,-0.799183437,1.224172773,-0.618827611,0.385274024,1.401006148,2.244521111,-0.69838695,0.224793316,-1.165781504,-0.514937741,-0.814986357,-0.884230299

3,1_Rumen Sources_03,Most,23.251,0.116442367,1.170267955,0.829568657,0.782873639,-0.421932433,1.402704804,0.744318438,2.444027811,-0.808078675,1.272792105,-0.676550068,1.334636633,-0.490720537,1.114082097,-0.55909459,-0.697014195,-0.52820838,-0.875814702,-0.427617716,1.347942816,0.729600065,0.736539943,-0.071335796,0.053082386,-1.09833153,3.178281912,0.165924769,-0.602955016,-0.114983499,1.685834271,2.202415558,-0.753825577,-0.211110731,1.480329851,0.001970526,0.687340523,-0.349798953,-0.647641003,0.39896416,3.179892866,-0.719475424,-0.232827002,-0.445721654,0.961339738,0.358193963,2.434712417,0.028732012,-0.043492993,4.527005342,-0.26551591,1.923108047,0.655061515,-1.116283781,0.556116111,-0.929608289,-0.91254834,1.521255216,-0.348095815,0.401528473,-0.020925337,1.088701118,-0.590524183,-0.453870275,1.157110578,-1.305446739,-0.203211446,-1.066931733,1.347266948,-0.355130744,0.272003999,1.183145663,-0.089915494,1.031235688,-0.424171881,2.186706432,0.509545336,0.975782325,-0.078659566,-1.095781084,-0.051758217,-0.058963427,0.730296678,-0.430598198,-0.322761325,-1.072707221,-0.978186691,-0.309490899,1.213599258,0.049001906,-0.804301642,0.053441825,1.392032316,-0.262053468,-0.662021764,-0.234808181,-0.018347483,-0.665537709,-0.789329193,-0.364998038,2.403548586,-0.612248186,-1.217620842,1.770305619,-1.290379826,-0.364815003,-0.366455938,-0.396375619,-0.52442884,-1.157337461,-0.647018436,0.279071087,-0.610423861,-0.365268668,-0.971169016,0.431825644,-0.043283637,1.358503449,0.10639528,0.45707172,0.01151386,-0.136501911,-0.650970229,0.650214907,0.074552848,-0.423967688,-0.488040909,-0.9112431,-0.736355558,-0.577402125,-0.629124035,-1.031734908,-0.596695043,-0.811481863,-0.924925091,-0.243735792,-0.801537738,-0.783842557,0.889505488,0.106882174,0.324714878,1.263701727

4,1_Rumen Sources_04,Most,18.876,1.035819517,0.820427323,0.31425758,0.518290523,-0.380952414,0.51459375,-0.105861666,0.447741021,0.095997316,1.126756672,-1.135468972,1.047758086,-0.630670087,0.422058405,-0.339879514,-0.317083247,-0.480719363,-0.739765817,-0.41616367,0.361422743,1.259208939,0.491586068,0.123648713,0.485088515,-0.162724454,-0.404862606,0.529616516,0.071401351,0.159699304,1.384223961,0.02736346,-0.431388231,-0.175437715,0.478079424,-0.739081731,0.383321397,1.194528344,-0.803610665,-0.107307117,-0.027207971,-0.070413453,-0.349489782,-0.281293849,-0.114731832,0.780017412,0.629489029,-0.384037744,-0.881917319,0.657731391,1.187592587,0.524534377,0.281246352,0.130514833,2.60922406,-0.296520816,-0.39609424,1.719671762,-0.317099941,1.484884998,0.374563531,0.680031469,-0.0938915,-0.623221094,0.33133044,-0.99590101,-0.307694408,-1.697291904,0.023438096,2.005496956,0.042167926,0.966617202,-0.397550896,0.462490745,-0.942819669,0.62548811,0.222609773,0.804525715,1.072182064,-0.239058351,-0.183708349,-0.717727233,0.345277342,-1.080112842,-0.054414727,0.437808853,-0.650706772,0.740132147,0.425768686,0.682257305,-0.459246818,0.565869663,1.489997511,0.963966457,0.298865931,-0.178510516,0.441562748,-0.525122801,-0.742995404,1.102314457,1.109835813,-0.605566583,1.273997941,0.152697904,-0.119038729,0.311476534,-0.400111548,-0.314299484,-0.118451619,-0.018635996,-0.540544524,-0.188544006,-0.025878318,1.891553012,-0.590478607,0.377640096,0.689733896,0.310238966,-0.243879286,0.858746738,-0.110898385,-1.114682048,-0.794892219,0.818547214,0.918720482,-0.407756343,-0.530529631,0.447051359,-0.594673035,-0.264522633,-0.252235629,0.01692966,-0.565163714,-0.626907572,-1.798370175,-0.646375733,0.760289362,-0.599561691,1.297464464,0.128005568,-0.11676939,0.906228642

6,1_Rumen Sources_06,Most,20.065,2.675224257,0.291779258,0.595601526,0.1002175,-1.040946404,0.606022636,0.124091114,0.766220422,-0.837242417,-0.068650758,-0.716943908,0.891425394,-0.113933287,0.079848887,-0.145662649,-0.455527303,-0.488857102,-0.547696801,0.29398718,0.573675878,0.900473872,0.499746507,-1.707303386,1.146322385,-0.432449016,0.004852534,0.103007631,-0.311589947,0.734616799,0.603337661,-0.878146034,-0.69116946,-0.387024993,0.109346786,-0.076927403,0.041543707,1.055009678,-0.70821095,-0.04300533,0.836567579,-0.2561911,2.466869389,-0.63732761,0.148831999,-0.047610875,0.199917457,-0.099955029,-0.700409434,0.082268513,-0.123127979,1.323125759,0.09858667,-0.044046725,0.635366289,-0.086638556,0.524093072,0.371475754,-0.214388125,-0.467751614,0.772668065,0.550244637,-0.388280994,-0.08492742,0.564248863,-0.33875065,-0.247854166,-0.17392149,-0.089516584,-1.352771983,0.112308635,0.947991097,-0.393026846,0.222062741,0.134371889,-0.805171897,-0.430476692,0.233703138,0.146199268,-0.409648076,-0.508918777,-0.241953373,-0.382806895,-0.880756862,0.581950064,-0.055879239,-0.432726587,-0.568776909,-0.192585179,2.730644669,-0.447348376,0.593485535,0.747553282,0.083864763,2.604670674,0.204313612,-0.176135833,0.309920406,-0.306133964,1.150181614,0.131984049,-0.187966457,1.679130532,0.250180854,-0.87969621,-0.478335368,-0.300315348,0.033546992,-0.147069685,-0.307790012,0.06719421,-0.512176322,0.777871803,0.204040118,0.95387161,-0.177485316,-0.422228829,-0.733936059,-0.136864708,0.630895997,0.072737906,-0.24504637,-0.352055328,2.572860264,0.67709279,-0.410371076,-0.504650136,0.033094952,-0.462436013,-0.553754257,-0.427810472,-0.38865141,-0.508164771,-0.347069131,-0.587965047,-0.644306669,-0.091420968,-0.393613999,0.768150603,-0.691846167,-0.596643594,1.089089874

11,1_Rumen Sources_11,Most,24.813,0.19455761,0.068917819,0.483534423,0.385503676,-0.478010353,0.866124276,0.388372472,1.821545346,-0.131479869,1.244583181,-0.982870021,1.222625065,-0.189290737,1.813710444,-0.261039004,-0.363231266,-0.914184898,-0.319614846,1.714288879,1.014329635,0.634003998,0.374515923,1.155639896,0.705499805,-0.348160091,1.461262358,-0.299048224,-0.634976639,0.581305467,0.264157731,-0.393378325,-0.811897099,-0.381578731,0.051051912,0.040035316,0.468312995,0.689374555,-0.77956284,-0.625512132,2.47445925,-0.4820343,0.832094788,-1.153712453,0.887046577,-0.133043472,1.502269364,0.779001745,-0.154593905,0.145039104,-0.707711857,0.816215516,0.778250603,-0.836400165,0.61317624,-0.591273498,0.375215606,0.698714983,-0.493350987,0.943206736,-0.09468715,0.318534812,-1.117074498,0.0521661,0.392078029,-0.67240035,-0.32099224,-0.751751647,0.832193607,-0.903288343,0.711635942,1.478835068,0.276532558,0.485032017,-1.242039546,-0.095572507,0.666215674,-1.061394236,0.943993989,-0.626130966,-0.315991689,-0.010166108,0.286715945,-1.240883793,1.047084168,-0.024793345,-1.056379984,-0.439827182,0.195689628,0.120081594,-0.903455327,0.498364199,1.654070755,2.826720825,-0.307633353,3.107396584,-0.717998153,-0.718370592,-0.802567418,0.285679702,1.507618485,-0.23028327,-0.589291852,0.911237115,-0.9368348,-0.888940944,-0.367919226,0.592446386,-1.500770781,-0.34968768,-0.492691081,-0.061701189,0.279679579,0.17001768,0.751611397,-0.041468532,0.64730374,-0.548547281,-0.381115573,1.497668405,0.025009676,-0.249142387,-0.436194337,1.081263929,0.120431524,-0.433236466,-0.461968284,-0.018649599,-0.292416985,-0.424600513,-0.345998111,-0.939657044,-0.346566707,-0.537597431,-1.164215558,-0.614925953,0.769124036,-0.784971038,2.730484917,-0.48985371,-0.551055545,0.820641336

14,1_Rumen Sources_14,Most,14.345,-0.430025879,0.160088408,0.446978529,0.666926601,0.151787834,1.189671631,0.790029009,1.161424406,-0.819744172,0.951644348,-1.576996085,0.997796091,-0.609139387,0.505709621,0.440833825,-1.036486606,-1.014996157,1.078887672,0.614700467,1.125432472,0.373862784,0.265656468,-0.342411821,1.560695611,-0.452116432,0.667127355,0.588697242,-0.158139791,-0.140535388,0.698490623,-0.232398859,-0.837025395,-0.24269905,0.171504573,-0.013370738,0.445602125,0.429581178,-0.848662805,-0.539659419,0.778035197,-0.321561214,-0.439230382,-1.096638339,-0.018032798,-0.047610875,1.434651616,2.541771409,-0.747562728,-0.26645699,-0.69309726,-0.008967879,0.459658134,2.404203507,1.689921993,-0.568335546,0.880331846,0.563229057,-0.69087371,-0.007162911,-0.355730727,1.14284007,-0.626425341,-0.99418003,0.422886299,-1.15003956,-0.542306151,-1.017432296,-1.598591112,1.516040579,0.473032281,2.733768842,1.520646316,0.35686983,-1.341779505,0.200426115,-0.148822152,0.330299341,-0.562870234,-0.815138342,-0.325654704,-0.241953373,0.464803776,-1.440239773,0.047812549,-1.357192561,-0.909166913,0.770636383,0.236353544,-0.551944545,-0.641689599,0.255958216,2.26480503,-1.016645008,-0.445414877,-0.368045991,-0.555317141,-0.804179702,-0.842282094,2.528071946,1.886774241,-0.880625867,1.330908577,1.508320189,-0.27259869,-0.876864309,-0.34889649,-0.505810465,0.610976307,-0.636011035,-0.739734484,0.587945969,-0.371291593,0.072486693,-0.581571843,-1.125179496,-2.204295406,-0.449426601,-1.243177447,0.226872001,0.134105333,-0.53842361,-0.949885131,0.064816453,0.641919139,-0.434282359,-0.511989097,-1.138919124,-0.708019054,-0.788413876,-0.715072976,-0.731385683,-0.631561418,-1.007964173,-1.498385043,-1.082120705,-0.325420442,-0.433223665,0.455726324,-0.559824953,-0.743005226,0.765989201

15,1_Rumen Sources_15,Most,30.556,-0.769360119,-0.669634625,-1.265690979,-1.269453315,1.586088499,-1.363631528,1.140679609,-0.639431843,1.338372711,-1.395555176,1.089558381,-1.047422319,-0.463807162,-0.703430675,1.244622436,0.811962799,0.190486101,-0.043515636,0.316895272,-1.095710263,-1.038427546,-1.094242548,-0.72762512,2.310093997,-0.505499419,-0.186707923,-1.231296057,-1.067744124,-0.255518886,-1.122407016,0.367615513,1.238136981,-0.345633402,-1.050229567,0.076715932,0.161785919,-1.278319726,1.403957839,0.074647285,-0.674447543,3.937407147,0.33702581,0.79360197,0.578670999,-1.489285955,-0.331933059,-0.425314719,0.88084076,-0.442662065,-0.876823622,-1.183171442,-1.290476495,0.275820264,-0.58931313,-0.365334672,-0.262675116,0.72092579,3.57197054,-0.305572493,-0.287200249,-1.546387091,1.179402897,-0.653462312,-1.15896039,0.183924926,-0.433833839,-0.73356818,-0.430639718,0.776405186,-0.286616647,-0.844771436,-0.112535744,-1.236732062,1.032031521,0.310553549,0.139873752,-0.791574086,-0.360819779,-0.603939205,0.555345675,1.130471223,-1.268657284,0.23820896,-0.982127253,1.062110908,-0.383946785,0.037148152,-0.584532856,-1.036578779,1.345350251,1.271608601,-0.115519377,-0.880420571,-0.166594583,-0.007740929,1.800499628,2.256227056,2.791610792,0.079219708,-0.423453399,-0.76035703,-1.220288529,-0.82822429,-0.065471301,-0.835803752,-0.240027908,-0.525352402,0.318805815,-0.588936745,-0.01236214,0.585350083,0.296285986,-1.027572116,-0.030178297,-0.521397673,-0.880181898,-0.794109517,0.304074986,-0.27346004,-0.777552246,-0.483127377,-1.215587265,-1.030419147,-0.792554124,0.644574515,2.580417326,0.263358203,0.992171225,0.172053403,1.674031818,-0.515075779,1.599583346,0.450768128,-0.207053692,-0.540853446,0.261727218,-0.432433729,-0.240127752,-0.326807512,-0.812586986,-0.130787028

18,1_Rumen Sources_18,Most,29.638,-0.24333451,-0.986493648,-1.128218235,-0.951379041,0.527078534,-0.959100619,-1.256355961,-0.34411458,0.195154038,-1.195271811,-0.695063911,-0.945080815,-1.271208412,-1.144500721,-0.776386726,2.475820129,2.30760982,-0.333619878,0.706332835,-1.046556906,-1.102713403,-1.156139278,-1.360135845,-1.101872775,1.933260167,0.731767045,-0.868371592,-1.001798603,-0.951807852,-0.769182368,1.463373466,0.036606864,-0.081489695,-0.935395688,-0.44044615,-0.510901681,0.121677917,-0.10219757,-1.166180654,0.275604061,1.634270422,-0.274705949,2.111742229,1.563350188,-0.77912749,-0.058052772,-0.073246398,-0.441389283,-0.412263729,-0.738611291,-1.044394376,-0.687274754,-0.843226595,-0.897860491,-0.835562686,-1.228976113,0.236730189,-0.910275873,-0.895904492,-0.282492048,-0.949758733,1.001093813,0.360626521,-1.260825171,-1.15257682,-0.325551497,-0.768924921,-1.426899998,-0.252543371,-0.622916295,-0.847099699,-0.438267347,-1.200056604,1.065278174,-0.383099788,-0.699808846,-0.913057091,-1.800614281,-1.047925382,0.715951645,-0.833620866,-1.045337329,-0.154072162,-0.810896567,-0.863352459,0.366242873,-0.471717975,-1.010061057,-0.157775367,-0.673418778,-0.959140129,-0.489462747,0.126721889,0.862695287,0.157398891,0.14433353,-0.987144583,0.448444887,-1.368630315,0.483444524,-0.544318565,0.473336431,-0.846502343,1.8736696,-1.115981674,0.024241794,-0.52926079,0.01964719,-1.245766552,-0.603352169,-0.14345382,0.253109327,-1.499349915,-1.060236652,1.176047561,-1.00454615,-0.880961822,1.615498997,-1.39627091,-0.885285775,-0.876601041,-0.949885131,-0.43883596,-1.263575195,-0.248906804,-0.328901333,-0.454597439,-0.604118537,-0.513734787,-0.142846068,-0.514345003,-0.528478224,0.194745724,-0.199379654,-0.606649696,-0.592132087,-0.767141046,-0.668742878,-0.138677283,-0.200747375,1.489872198

19,1_Rumen Sources_19,Most,26.509,-2.036059029,-0.951391793,-1.190838435,-0.715621715,-1.30192442,-1.166717694,-1.557704879,-0.685756119,-0.72058745,-0.644980788,2.766463767,-1.077238348,0.704233312,-1.517128862,0.390837404,-1.106656881,1.075138572,0.700751798,0.557430237,-1.140598247,-0.927842548,-1.304363809,1.012968304,-1.119505678,1.396620673,-0.727155215,-0.902132007,-0.843275715,-0.466321968,-0.910682898,-0.868999473,2.300694266,-0.328205364,-1.111685006,1.22881025,3.860731739,-1.028148326,1.197667898,-0.287015169,-0.699822853,-0.366265937,1.401947599,2.141638193,-1.483848645,-1.17959279,-1.260966814,0.999954968,3.870876359,-0.396209196,-0.812101835,-1.035253371,-0.72975375,-1.408845051,-1.494878499,0.178294789,-1.073364751,-1.665995645,0.144191588,-0.633174317,-1.019587041,-1.181835188,-0.1393663,3.352490987,-1.278875658,2.284776269,-0.509251541,0.456438682,-0.816944725,0.589399866,4.134753036,-1.089239055,-0.773047049,-1.297013446,0.074527914,1.10137815,-0.287889081,-0.820789027,-0.335830271,0.313018306,3.97838535,3.39344689,-0.402254523,0.489011644,-1.130356803,1.879730746,1.611365498,-0.388524603,-0.612866423,-1.60521628,2.876283149,-1.041987744,-1.505229396,-0.670726777,-1.52128337,-0.775265774,1.97418913,-0.263795054,-0.114179695,-1.060649865,-0.707758944,1.580430879,-1.227935895,-0.231141216,1.302283699,-0.475920041,3.834934811,1.389757409,-0.572680231,-0.0052776,4.354264596,-0.805902608,-0.032520881,-1.524299702,1.329253352,2.274134283,1.84120056,-0.960414155,1.84389585,-0.393257852,-1.54401779,3.84559493,-0.345412775,-1.670135693,-1.437914163,-0.403049824,-0.534392242,0.271119886,0.312095114,-0.044415548,-0.567994574,-0.325073837,-0.361726,1.326007508,0.54430442,0.81645283,0.718264966,-0.747054093,-0.70876417,1.089120001,2.820060741,-0.967067811

21,1_Rumen Sources_21,Most,11.692,0.991888154,-1.108996764,-1.218125974,-0.711312705,0.046102521,-0.857613266,-1.079904635,-0.829071849,0.504289699,-0.832895625,-0.171066042,-0.704135068,-1.228147012,0.01901164,-0.45525587,-0.957466027,0.03419197,3.001578543,-0.141266567,-0.719443342,-1.112706023,-0.981252623,-0.656289324,-0.392148421,-0.814558813,-0.177188011,-0.994205867,-0.817912052,-0.862376242,-1.030062998,-0.208617802,0.162602437,-0.308326507,-0.892201293,0.033056771,-0.307618498,-0.931928557,1.1260294,-1.151649573,-0.091153752,0.212154136,1.69809158,-0.058433022,0.032085604,-0.293229592,-0.055779906,0.776573688,0.037894885,-0.402262544,-0.863044145,-1.059352383,-0.241245297,0.158308154,-0.907370512,-0.204769008,1.210135941,-1.691167893,1.613760649,-1.126198843,0.348929993,-0.932038309,0.443429162,-0.046621877,-1.2977161,-0.553783442,0.015442898,-1.303316797,-1.042854085,0.025868138,-0.302899311,0.256496977,3.054299276,-1.136801534,-0.131601335,-0.322305458,-1.219109404,-1.02244098,-0.56330646,-0.717766331,-0.484927844,-0.479840303,-1.143012495,-0.842171834,-0.603886333,-0.200326044,-2.265245384,0.005257359,-1.220201679,0.572406879,-0.546502061,-1.186203962,0.513102537,-0.768685922,1.010574275,-0.829686851,-1.093509964,-0.157420123,-0.650327825,0.862189648,1.067251254,-0.401777722,0.915105243,-0.937892609,-1.151104513,-0.538718541,-0.394258399,-0.611336924,2.968639104,-0.64083867,-0.611726522,0.494529631,0.356069053,-0.383413968,-0.18572224,-0.760256416,-0.619748523,-0.827409392,-0.336526165,-1.104997797,-1.273976018,-0.654392101,-0.595615618,-0.11588532,-0.758909762,-0.399479361,-0.50233257,1.118436906,-0.500218019,-0.719289337,-0.470555133,-0.857810053,-0.631864603,-1.412836812,0.061537648,-0.267736939,-0.797478564,-0.848391642,-0.293059138,-0.316245815,-0.620637304,-0.712368239

24,1_Rumen Sources_24,Most,29.189,-0.80753776,-0.086331323,-0.973243828,-1.124630958,-1.470158182,-0.961937622,-1.235661428,-0.749451999,2.586580853,-0.91144663,0.112251863,-1.417302245,3.406336162,-0.665407396,-0.626397464,0.179798159,2.177552233,-0.085530733,-0.324531302,-1.26906725,-1.067073057,-1.02913993,-1.141372737,-0.643417291,-1.179810825,0.129893247,-0.479359534,-0.137531816,-0.319398608,-0.691936421,1.104828292,-0.188820972,-0.376404782,-0.402313646,0.237280138,0.060771315,0.525800948,1.917355702,-0.547381249,-0.028899659,0.36440324,-0.780244663,1.994876185,0.394117354,-0.666997205,0.156733014,-0.840512533,0.78395043,-0.555438577,-0.880999221,-0.977083344,-0.878430235,1.043793599,-1.337434812,-0.699081872,-1.721465209,0.00129563,1.526242889,-0.6915588,-0.535165491,-0.324044438,0.823981434,0.630781398,-0.838988855,0.235304442,-0.610315061,0.038218953,-1.713804886,0.257039139,-0.383060121,-1.049658583,0.014137656,-0.785319215,-0.976066322,0.10325485,-0.235078855,-0.65130302,-0.08500042,-0.672929917,0.990181339,-0.540836952,-0.323371447,1.357174781,-0.874788614,-1.353316325,-0.023704314,-0.973651321,-0.736169909,-0.623024232,0.258625862,-1.600442034,-0.952183354,-0.585012525,-0.521960167,-0.628891843,-0.067274103,0.762013862,0.38225376,-1.726055961,-0.802364065,0.101569631,-0.888250536,-0.681999863,-1.040398494,-0.647408252,2.457103406,-1.322663426,-0.303137978,-0.958764615,-0.271967072,-0.367980185,1.46205579,-1.551517652,-0.840162912,-1.006855952,1.216453082,-0.42547406,1.013046561,-0.691577895,-0.713854864,-0.094005731,-0.166063834,-0.66713329,-0.185426315,-0.31393251,-0.396883287,0.54019155,-0.547445527,0.246635142,-0.30968813,0.28512471,-0.557584067,-0.781711817,0.967771805,0.282634203,-0.863858006,-0.275236395,-0.587409285,-0.408000558,-0.075980082,-0.444263425

###################################################################
#notes ends here
############################################################################
NOTES

############################################################################
#code goes here

source ~/.bashrc    
echo "STARTING"
OUTDIR="/home/jknorris/storage/ctbrownroot/Hugo/BOSTAURUS/"
REFERENCE="${OUTDIR}/Bos_taurus.ARS-UCD1.3.dna.toplevel.fa"
GTF="${OUTDIR}/Bos_taurus.ARS-UCD1.3.113.gtf"
HISAT2_INDEX="${OUTDIR}/HISAT2/Bos_taurus.ARS-UCD1.3"
FASTQC_OUTDIR="${OUTDIR}/HISAT2/fastqc"
ALIGN_OUTDIR="${OUTDIR}/HISAT2/ALIGN"
sample_name=$(get_samplename "$1" | sed 's/_S.*//')
output_prefix="${ALIGN_OUTDIR}/${sample_name}"

build_hisat2_index() {
    if [ ! -s ${HISAT2_INDEX}.1.ht2l ]; then
        mkdir -p ${OUTDIR}/HISAT2/
	load_hisat2
        hisat2-build-l -p $(nproc) ${REFERENCE} ${HISAT2_INDEX}
    fi
}

run_fastqc() {
    local input1=$1
    local input2=$2

    [ ! -d ${FASTQC_OUTDIR} ] && mkdir -p ${FASTQC_OUTDIR}

    load_fastqc
	if [[ ! -s "${FASTQC_OUTDIR}/${sample_name}"*_fastqc.zip && ! -s "${FASTQC_OUTDIR}/${sample_name}"*_fastqc.html ]]; then
        	fastqc ${input1} ${input2} -o ${FASTQC_OUTDIR} --threads $(nproc)
	fi
}

run_hisat2() {
local input1=$1
local input2=$2

[ ! -d ${ALIGN_OUTDIR} ] && mkdir -p ${ALIGN_OUTDIR}

if [ ! -s ${output_prefix}.sam ] 
then
    load_hisat2
    hisat2 -q -t --threads $(nproc) --quiet --summary-file ${output_prefix}.summary -x ${HISAT2_INDEX} \
	-1 ${input1} -2 ${input2} -S ${output_prefix}.sam

    load_samtools
    samtools collate -@ $(nproc) -o ${output_prefix}.sort.sam ${output_prefix}.sam
	mv ${output_prefix}.sort.sam ${output_prefix}.sam
    [ ! -s  ${output_prefix}.flagstat ] && samtools flagstat -@ $(nproc) -O tsv ${output_prefix}.sam > ${output_prefix}.flagstat
fi

}

run_featurecounts() {

if [ ! -s ${output_prefix}.counts ] 
then
    load_featurecounts
    featureCounts -p -t exon -g gene_id -T $(nproc) -a ${GTF} -o ${output_prefix}.counts ${output_prefix}.sam
	load_pigz 
	pigz -p $(nproc) ${1}
fi

}

#############################################################################################################################################

process_sam() {
    echo "Processing SAM: ${sample_name}"

        if [[ ${1} =~ ".gz" ]]; then
		load_pigz
            pigz -d -p $(nproc) ${1}
            pigz -d -p $(nproc) ${1/_R1_001_/_R2_001_}
	R1=${1/.gz/}
	R2=${1/_R1_001_trim.fixed.gz/_R2_001_trim.fixed}
        	echo "${sample_name} - pigz done"
	else 	
	R1=${1}
	R2=${1/_R1_001_/_R2_001_}
        fi

if [[ ! "$R1" == *.fq* || ! "$R2" == *.fq* ]]; then
mv ${R1} ${R1}.fq
R1=${R1}.fq
mv ${R2} ${R2}.fq
R2=${R2}.fq
fi

    run_fastqc ${R1} ${R2}
    run_hisat2 ${R1} ${R2}
    run_featurecounts ${output_prefix}.sam
}

#############################################################################################################################################

main() {
build_hisat2_index
process_sam ${1}
}

main "$@"

printf "Time Used: $(squeue -h -j $SLURM_JOBID -o "%M")\nTime Left: $(squeue -h -j $SLURM_JOBID -o "%L")\nTime Requested: $(squeue -h -j $SLURM_JOBID -o "%l")\nDays Until Halloween: $(fHalloween)"
exit 0
